# -*- coding: utf-8 -*-
"""
Created on Thu Feb  7 16:35:35 2019

@author: Fiorito_L
"""

__author__ = "Luca Fiorito"

import pytest

import numpy as np
import pandas as pd

import sandy

@pytest.fixture(scope="module")
def text_cov_p6():
    """JEFF-3.3 covariance for 22-Ti-46g"""
    text = """
 2.204600+4 4.555788+1          0          1          0          1222534  2    1
 0.000000+0 0.000000+0          0          2          6          6222534  2    2
 0.000000+0 0.000000+0          1          1          0          1222534  2    3
 0.000000+0 0.000000+0          1          5         10          4222534  2    4
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 2.681630-1 2.600650-1222534  2    5
 2.568630-1 2.522610-1 2.491760-1 2.461360-1                      222534  2    6
 0.000000+0 0.000000+0          1          2          0          1222534  2    7
 0.000000+0 0.000000+0          1          5         10          4222534  2    8
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 6.359650-2 3.639500-2222534  2    9
 2.533320-2 3.521620-2 2.449080-2 2.413570-2                      222534  2   10
 0.000000+0 0.000000+0          1          3          0          1222534  2   11
 0.000000+0 0.000000+0          1          5         10          4222534  2   12
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 0.000000+0 0.000000+0222534  2   13
 0.000000+0 0.000000+0 0.000000+0 0.000000+0                      222534  2   14
 0.000000+0 0.000000+0          1          4          0          1222534  2   15
 0.000000+0 0.000000+0          1          5         10          4222534  2   16
 3.900000+5 4.630000+5 5.005000+5 2.000000+8-1.258140-1-1.330910-1222534  2   17
-1.360340-1-1.293650-1-1.322170-1-1.307200-1                      222534  2   18
 0.000000+0 0.000000+0          1          5          0          1222534  2   19
 0.000000+0 0.000000+0          1          5         10          4222534  2   20
 3.900000+5 4.630000+5 5.005000+5 2.000000+8-8.310390-2-9.272680-2222534  2   21
-9.654330-2-9.103580-2-9.471800-2-9.395350-2                      222534  2   22
 0.000000+0 0.000000+0          1          6          0          1222534  2   23
 0.000000+0 0.000000+0          1          5         10          4222534  2   24
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 2.420940-1 1.792650-1222534  2   25
 1.554070-1 1.723050-1 1.492910-1 1.469040-1                      222534  2   26
 0.000000+0 0.000000+0          2          2          0          1222534  2   27
 0.000000+0 0.000000+0          1          5         10          4222534  2   28
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 2.013440-2 1.318180-2222534  2   29
 1.031750-2 9.065170-3 7.355660-3 6.117100-3                      222534  2   30
 0.000000+0 0.000000+0          2          3          0          1222534  2   31
 0.000000+0 0.000000+0          1          5         10          4222534  2   32
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 0.000000+0 0.000000+0222534  2   33
 0.000000+0 0.000000+0 0.000000+0 0.000000+0                      222534  2   34
 0.000000+0 0.000000+0          2          4          0          1222534  2   35
 0.000000+0 0.000000+0          1          5         10          4222534  2   36
 3.900000+5 4.630000+5 5.005000+5 2.000000+8-2.850840-2-2.979540-2222534  2   37
-3.029250-2-1.634730-2-1.656400-2-1.098310-2                      222534  2   38
 0.000000+0 0.000000+0          2          5          0          1222534  2   39
 0.000000+0 0.000000+0          1          5         10          4222534  2   40
 3.900000+5 4.630000+5 5.005000+5 2.000000+8-2.234770-2-2.390560-2222534  2   41
-2.449520-2-1.519380-2-1.540100-2-1.157050-2                      222534  2   42
 0.000000+0 0.000000+0          2          6          0          1222534  2   43
 0.000000+0 0.000000+0          1          5         10          4222534  2   44
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 5.538910-2 4.023430-2222534  2   45
 3.443830-2 2.148730-2 1.817290-2 1.171590-2                      222534  2   46
 0.000000+0 0.000000+0          3          3          0          1222534  2   47
 0.000000+0 0.000000+0          1          5         10          4222534  2   48
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 9.485360-1 1.084340+0222534  2   49
 1.180300+0 1.240490+0 1.350830+0 1.471360+0                      222534  2   50
 0.000000+0 0.000000+0          3          4          0          1222534  2   51
 0.000000+0 0.000000+0          1          5         10          4222534  2   52
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 0.000000+0 0.000000+0222534  2   53
 0.000000+0 0.000000+0 0.000000+0 0.000000+0                      222534  2   54
 0.000000+0 0.000000+0          3          5          0          1222534  2   55
 0.000000+0 0.000000+0          1          5         10          4222534  2   56
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 0.000000+0 0.000000+0222534  2   57
 0.000000+0 0.000000+0 0.000000+0 0.000000+0                      222534  2   58
 0.000000+0 0.000000+0          3          6          0          1222534  2   59
 0.000000+0 0.000000+0          1          5         10          4222534  2   60
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 0.000000+0 0.000000+0222534  2   61
 0.000000+0 0.000000+0 0.000000+0 0.000000+0                      222534  2   62
 0.000000+0 0.000000+0          4          4          0          1222534  2   63
 0.000000+0 0.000000+0          1          5         10          4222534  2   64
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 6.436720-2 6.748940-2222534  2   65
 6.874280-2 7.094100-2 7.232950-2 7.377380-2                      222534  2   66
 0.000000+0 0.000000+0          4          5          0          1222534  2   67
 0.000000+0 0.000000+0          1          5         10          4222534  2   68
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 4.616480-2 5.051530-2222534  2   69
 5.220440-2 5.081890-2 5.270430-2 5.296820-2                      222534  2   70
 0.000000+0 0.000000+0          4          6          0          1222534  2   71
 0.000000+0 0.000000+0          1          5         10          4222534  2   72
 3.900000+5 4.630000+5 5.005000+5 2.000000+8-9.078690-2-6.518290-2222534  2   73
-5.552480-2-7.356890-2-6.304810-2-6.603970-2                      222534  2   74
 0.000000+0 0.000000+0          5          5          0          1222534  2   75
 0.000000+0 0.000000+0          1          5         10          4222534  2   76
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 1.910090-1 1.629760-1222534  2   77
 1.596570-1 1.579390-1 1.557470-1 1.537410-1                      222534  2   78
 0.000000+0 0.000000+0          5          6          0          1222534  2   79
 0.000000+0 0.000000+0          1          5         10          4222534  2   80
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 5.354350-2 5.705510-2222534  2   81
 5.775390-2 4.420400-2 4.611200-2 4.110950-2                      222534  2   82
 0.000000+0 0.000000+0          6          6          0          1222534  2   83
 0.000000+0 0.000000+0          1          5         10          4222534  2   84
 3.900000+5 4.630000+5 5.005000+5 2.000000+8 5.685560-1 4.462360-1222534  2   85
 3.994140-1 3.528830-1 3.170000-1 2.852580-1                      222534  2   86
    """
    return text

@pytest.mark.formats
@pytest.mark.utils
@pytest.mark.cov
def test_cov_p6(text_cov_p6):
     tape = sandy.formats.endf6.Endf6.from_text(text_cov_p6)
     A = sandy.LpcCov.from_endf6(tape)